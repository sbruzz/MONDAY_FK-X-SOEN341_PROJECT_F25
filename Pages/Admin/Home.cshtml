@page
@model AdminHomeModel
@{
    ViewData["Title"] = "Admin Dashboard";
    Layout = "_AdminLayout";
}

<div class="container mt-4">
    <h1 class="mb-4">Admin Dashboard</h1>

    <!-- Global Statistics Cards -->
    <div class="row g-4 mb-5">
        <div class="col-md-3">
            <div class="stat-card bg-primary-gradient">
                <div class="stat-icon">
                    <i class="bi bi-calendar-event"></i>
                </div>
                <div class="stat-content">
                    <h3 class="stat-number">@Model.TotalEvents</h3>
                    <p class="stat-label">Total Events</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="stat-card bg-success-gradient">
                <div class="stat-icon">
                    <i class="bi bi-ticket-perforated"></i>
                </div>
                <div class="stat-content">
                    <h3 class="stat-number">@Model.TotalTicketsIssued</h3>
                    <p class="stat-label">Tickets Issued</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="stat-card bg-info-gradient">
                <div class="stat-icon">
                    <i class="bi bi-people"></i>
                </div>
                <div class="stat-content">
                    <h3 class="stat-number">@Model.TotalUsers</h3>
                    <p class="stat-label">Total Users</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="stat-card bg-warning-gradient">
                <div class="stat-icon">
                    <i class="bi bi-building"></i>
                </div>
                <div class="stat-content">
                    <h3 class="stat-number">@Model.TotalOrganizations</h3>
                    <p class="stat-label">Organizations</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Pending Actions Alert -->
    @if (Model.PendingUsers > 0 || Model.PendingEvents > 0)
    {
        <div class="alert alert-danger mb-4">
            <h5><i class="bi bi-exclamation-triangle"></i> Pending Actions Required</h5>
            <p class="mb-0">
                @if (Model.PendingUsers > 0)
                {
                    <span>@Model.PendingUsers user(s) awaiting approval. </span>
                }
                @if (Model.PendingEvents > 0)
                {
                    <span>@Model.PendingEvents event(s) awaiting moderation.</span>
                }
            </p>
        </div>
    }

    <!-- Quick Actions -->
    <div class="row g-4 mb-5">
        <div class="col-md-6 col-lg-3">
            <div class="card action-card">
                <div class="card-body text-center">
                    <div class="action-icon bg-primary-light">
                        <i class="bi bi-person-check"></i>
                    </div>
                    <h5 class="card-title">User Management</h5>
                    <p class="card-text">Approve organizers and manage users</p>
                    @if (Model.PendingUsers > 0)
                    {
                        <span class="badge bg-danger mb-2">@Model.PendingUsers pending</span>
                    }
                    <a href="/Admin/Users" class="btn btn-primary w-100">Manage Users</a>
                </div>
            </div>
        </div>
        <div class="col-md-6 col-lg-3">
            <div class="card action-card">
                <div class="card-body text-center">
                    <div class="action-icon bg-success-light">
                        <i class="bi bi-calendar-check"></i>
                    </div>
                    <h5 class="card-title">Event Moderation</h5>
                    <p class="card-text">Review and approve event listings</p>
                    @if (Model.PendingEvents > 0)
                    {
                        <span class="badge bg-danger mb-2">@Model.PendingEvents pending</span>
                    }
                    <a href="/Admin/Events" class="btn btn-primary w-100">Moderate Events</a>
                </div>
            </div>
        </div>
        <div class="col-md-6 col-lg-3">
            <div class="card action-card">
                <div class="card-body text-center">
                    <div class="action-icon bg-info-light">
                        <i class="bi bi-building"></i>
                    </div>
                    <h5 class="card-title">Organizations</h5>
                    <p class="card-text">Manage campus organizations</p>
                    <a href="/Admin/Organizations" class="btn btn-primary w-100">Manage Orgs</a>
                </div>
            </div>
        </div>
        <div class="col-md-6 col-lg-3">
            <div class="card action-card">
                <div class="card-body text-center">
                    <div class="action-icon bg-warning-light">
                        <i class="bi bi-graph-up"></i>
                    </div>
                    <h5 class="card-title">Analytics</h5>
                    <p class="card-text">View platform statistics</p>
                    <a href="#analytics" class="btn btn-primary w-100">View Stats</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Participation Trends -->
    <div class="card mb-4" id="analytics">
        <div class="card-header">
            <h4 class="mb-0"><i class="bi bi-graph-up"></i> Participation Trends</h4>
        </div>
        <div class="card-body">
            <div class="row g-4">
                <div class="col-md-6">
                    <h5>Events by Category</h5>
                    <div class="category-stats">
                        @foreach (var stat in Model.EventsByCategory)
                        {
                            <div class="category-stat-item">
                                <div class="d-flex justify-content-between mb-1">
                                    <span>@stat.Category</span>
                                    <strong>@stat.Count events</strong>
                                </div>
                                <div class="progress">
                                    <div class="progress-bar" style="width: @((stat.Count * 100.0 / (Model.TotalEvents > 0 ? Model.TotalEvents : 1)).ToString("F0"))%"></div>
                                </div>
                            </div>
                        }
                    </div>
                </div>
                <div class="col-md-6">
                    <h5>Recent Activity</h5>
                    <ul class="list-group">
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            Events this month
                            <span class="badge bg-primary rounded-pill">@Model.EventsThisMonth</span>
                        </li>
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            Tickets issued this month
                            <span class="badge bg-primary rounded-pill">@Model.TicketsThisMonth</span>
                        </li>
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            Average attendance rate
                            <span class="badge bg-primary rounded-pill">@Model.AverageAttendanceRate.ToString("F1")%</span>
                        </li>
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            Active organizers
                            <span class="badge bg-primary rounded-pill">@Model.ActiveOrganizers</span>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .stat-card {
        border-radius: 15px;
        padding: 1.5rem;
        color: white;
        display: flex;
        align-items: center;
        gap: 1rem;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s ease;
    }

    .stat-card:hover {
        transform: translateY(-5px);
    }

    .bg-primary-gradient {
        background: linear-gradient(135deg, #d4756e 0%, #c15f58 100%);
    }

    .bg-success-gradient {
        background: linear-gradient(135deg, #e8b17e 0%, #d4756e 100%);
    }

    .bg-info-gradient {
        background: linear-gradient(135deg, #d5bdaf 0%, #c9a999 100%);
    }

    .bg-warning-gradient {
        background: linear-gradient(135deg, #e3d5ca 0%, #d5bdaf 100%);
    }

    .stat-icon {
        font-size: 2.5rem;
        opacity: 0.8;
    }

    .stat-content {
        flex: 1;
    }

    .stat-number {
        font-size: 2rem;
        font-weight: 800;
        margin: 0;
    }

    .stat-label {
        margin: 0;
        font-size: 0.9rem;
        opacity: 0.9;
    }

    .action-card {
        border-radius: 15px;
        border: none;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
        transition: all 0.3s ease;
        height: 100%;
    }

    .action-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.12);
    }

    .action-icon {
        width: 70px;
        height: 70px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 1rem;
        font-size: 2rem;
    }

    .bg-primary-light {
        background: rgba(212, 117, 110, 0.15);
        color: #d4756e;
    }

    .bg-success-light {
        background: rgba(232, 177, 126, 0.15);
        color: #e8b17e;
    }

    .bg-info-light {
        background: rgba(213, 189, 175, 0.15);
        color: #c9a999;
    }

    .bg-warning-light {
        background: rgba(227, 213, 202, 0.15);
        color: #d5bdaf;
    }

    .category-stat-item {
        margin-bottom: 1rem;
    }

    .progress {
        height: 10px;
        border-radius: 5px;
    }

    .alert-danger {
        background: rgba(212, 117, 110, 0.1);
        border: 1px solid rgba(212, 117, 110, 0.3);
        color: #d4756e;
    }

    .alert-danger h5 {
        color: #c15f58;
    }

    .list-group-item {
        border-radius: 12px !important;
        margin-bottom: 0.5rem;
        border: 1px solid var(--border);
    }
</style>
